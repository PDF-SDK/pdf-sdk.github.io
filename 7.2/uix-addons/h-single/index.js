!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],t):"object"==typeof exports?exports.HSingleViewModeAddon=t(require("UIExtension")):e.HSingleViewModeAddon=t(e.UIExtension)}(self,(function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));n(2);var r=s(n(3)),i=s(n(4));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var r=n[o],i=Object.getOwnPropertyDescriptor(t,r);i&&i.configurable&&void 0===e[r]&&Object.defineProperty(e,r,i)}}(e,t))}var l=o.Controller,u=o.PDFViewCtrl.Events,f=function(e){function t(){return d(this,t),a(this,e.apply(this,arguments))}return c(t,e),t.getName=function(){return"h-single"},t.getLoader=function(){return r.default},t.prototype.init=function(t){e.prototype.init.call(this,t),t.getPDFViewer().then((function(e){e.getViewModeManager().register(i.default)})),o.modular.module("h-single",[]).registerFragment("h-single-button",{template:'\n            <xbutton @tooltip name="h-single-button" icon-class="fv__icon-toolbar-h-single-page">h-single:buttons.title</xbutton>\n            ',config:[{target:"h-single-button",tooltip:{title:"h-single:buttons.title"},callback:function(e){function t(n){d(this,t);var o=a(this,e.call(this,n));return o.viewModeName=i.default.getName(),o}return c(t,e),t.prototype.mounted=function(){var t=this;e.prototype.mounted.call(this),this.getPDFUI().addViewerEventListener(u.startChangeViewMode,(function(e,n){e.getName()===t.viewModeName?t.component.active():t.component.deactive()}))},t.prototype.handle=function(){var e=this;return this.getPDFUI().getViewModeManager().then((function(t){t.switchTo(e.viewModeName)}))},t}(l)}]})},t}(o.UIXAddon);t.default=f},function(e,t,n){},function(e,t){e.exports=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var r=n[o],i=Object.getOwnPropertyDescriptor(t,r);i&&i.configurable&&void 0===e[r]&&Object.defineProperty(e,r,i)}}(e,t))}var i=o.PDFViewCtrl,s=o.PDFViewCtrl.Deps,d=(o.UIEvents,s.jQuery),a=s.Hammer,c=o.PDFViewCtrl.Events,l=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n));return o.diffHCache=null,o.pdfViewer=n.pdfViewer,o.start=o.start.bind(o),o.end=o.end.bind(o),o.mousedown=o.mousedown.bind(o),o.mouseup=o.mouseup.bind(o),o.keydown=o.keydown.bind(o),o.keyup=o.keyup.bind(o),o.panning=!1,o.animating=!1,o.panType=null,o}return r(t,e),t.getName=function(){return"h-single-view-mode"},t.prototype.getItems=function(){return this.docRender.$container.find(".fv__pdf-view-mode-item")},t.prototype.disableScroll=function(){this.pdfViewer.eventEmitter.emit(c.disableScroll)},t.prototype.enableScroll=function(){this.pdfViewer.eventEmitter.emit(c.enableScroll)},t.prototype.into=function(){var e=this;this.disableScroll();var t=this.constructor.getName(),n=["<style>","."+t+"{","display:flex;","width:fit-content;","}","."+t+" .fv__pdf-view-mode-item{","display:flex;","align-items:center;","justify-content:center;","}","."+t+" .fv__pdf-page-layout.fv__rendering{","min-width:128px;","}","</style>"].join("");this.$style=d(n),this.docRender.pagesRender.$ui.append(this.$style),this.docRender.$container.addClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-y":"unset","overflow-x":"scroll"}),console.log("into");var o=this.docRender.viewerRender.scrollWrap;this.scrollHost=o.getScrollHost(),this.scrollHost.addEventListener("mousedown",this.mousedown),d(window).on("keydown",this.keydown),d(window).on("keyup",this.keyup),d(window).on("mouseup",this.mouseup),this.pdfViewer.eventEmitter.on(c.fitWidthResizeViewport,this.resize=function(){var t=e.docRender.getCurrentPageIndex();e.docRender.goToPage(t,{x:0,y:0})}),this.pdfViewer.eventEmitter.on(c.zoomToSuccess,this.zoom=function(){var t=e.docRender.getCurrentPageIndex();e.docRender.goToPage(t,{x:0,y:0})});var r=this.hammer=new a.Manager(this.scrollHost,{recognizers:[[a.Pan,{direction:a.DIRECTION_ALL}]]}),i=0,s=0;r.on("panstart",(function(){var t=e.allInVisible();e.leftIn=t.leftIn,e.rightIn=t.rightIn,e.panning=!0})),r.on("panmove",(function(t){if(e.panning&&!e.animating){var n=t.deltaX,o=t.deltaY,r=e.docRender.viewerRender.scrollWrap,d=r.getScrollLeft(),a=e.scrollHost.clientWidth+d,c=(r.getScrollTop(),e.docRender.getCurrentPageIndex()),l=e.getItems(),u=l.get(c).offsetLeft,f=u+l.eq(c).width(),p=i-n,h=s-o;i=n,s=o;var g=f-a,v=u-d;p>=0&&p>g&&(p=g),p<0&&p<v&&(p=v),r.scrollBy(p,h)}})),r.on("panend",(function(){1===e.panType?e.toNext():2===e.panType&&e.toPrev(),e.panning=!1,e.panType=null,i=0,s=0})),r.on("panleft",(function(){e.panning&&e.rightIn&&!e.animating&&(e.panType=1)})),r.on("panright",(function(){e.panning&&e.leftIn&&!e.animating&&(e.panType=2)})),this._unwatchScrollEvent=o.addScrollEventListener((function(){clearTimeout(e.scrollEventTimer),e.scrollEventTimer=setTimeout((function(){var t=e.docRender.pagesRender;t&&t.renderVisiblePages().then((function(){e.docRender.setCurrentPageIndex(e.getCurrentPageIndex())}),(function(){}))}),30)}))},t.prototype.toNext=function(){var e=this.docRender.getCurrentPageIndex();this.animation(e+1,!1)},t.prototype.toPrev=function(){var e=this.docRender.getCurrentPageIndex();this.animation(e-1,!0)},t.prototype.animation=function(e,t){var n=this.docRender,o=n.doc.getPageCount();if(!(e<0||e>=o)){this.animating=!0;var r=n.viewerRender.scrollWrap,i=this.scrollHost.clientWidth,s=this.getItems(),d=s.get(e).offsetLeft,a=d+s.eq(e).width(),c=r.getScrollLeft(),l=r.getScrollTop(),u=t?-i:i,f=30,p=0;p=t?a-c:d-c,!t&&p>i&&(u=p),t&&p<0&&(u-=p);var h=u/f,g=this,v=setInterval((function(){f>0?(c+=h,r.scrollTo(c,l),f--):(clearInterval(v),g.animating=!1,n.setCurrentPageIndex(e))}),10)}},t.prototype.allInVisible=function(){var e=this.docRender.getCurrentPageIndex(),t=this.getItems(),n=this.docRender.viewerRender.scrollWrap,o=this.scrollHost.clientWidth,r=this.scrollHost.clientHeight,i=(n.getScrollTop(),n.getScrollLeft()),s=i+o,d=t.get(e).offsetLeft,a=d+t.eq(e).width(),c=!1,l=!1;return Math.abs(i-d)<=1&&(c=!0),Math.abs(s-a)<=1&&(l=!0),{leftIn:c,rightIn:l}},t.prototype.renderViewMode=function(e,t,n,o,r){var i=e.index,s=this.getItems().eq(i),d=this.docRender.pagesRender.$ui,a=d.height(),c=this.scrollHost,l=c.clientWidth,u=c.clientHeight,f=s.find(".fv__pdf-page-layout").width(),p=(s.find(".fv__pdf-page-layout").height(),(u-a)/2);f<l?s.css({width:l}):s.css({width:""}),this.diffHCache!==p&&(p>0?d.css({paddingTop:p,paddingBottom:p}):d.css({paddingTop:"",paddingBottom:""}),this.diffHCache=p)},t.prototype.mousedown=function(e){var t=this.scrollHost,n=d(t).offset(),o=n.top,r=n.left,i=r+t.clientWidth,s=o+t.clientHeight;this.dragging=!0;var a=e.clientX,c=e.clientY;return this.scrollType=r<=a&&a<=i&&o<=c&&c<=s?0:i<a&&o<c?1:2,this.client={x:a,y:c},this.start(),!1},t.prototype.mouseup=function(e){this.dragging,this.client,this.panning;2===this.scrollType&&this.end()},t.prototype.keydown=function(e){var t=e.keyCode;if(37!==t&&39!==t||this.start(),35===t||36===t||34===t||33===t)return!1},t.prototype.keyup=function(e){var t=e.keyCode;if(37!==t&&39!==t||this.end(),e.preventDefault(),e.stopPropagation(),33===t&&this.toPrev(),34===t&&this.toNext(),35===t){var n=this.docRender.doc.getPageCount();this.docRender.goToPage(n-1,{x:0,y:0})}36===t&&this.docRender.goToPage(0,{x:0,y:0})},t.prototype.start=function(){this.scrollPageIndex=this.docRender.getCurrentPageIndex()},t.prototype.end=function(){var e=this.getVisibleIndexes();if(1!==e.length){var t=e.indexOf(this.scrollPageIndex),n=e.length-1;t>-1?t<n/2?this.docRender.goToPage(e[n],{x:0,y:0}):this.docRender.goToPage(e[0],{x:0,y:0}):e[0]>t?this.docRender.goToPage(e[n],{x:0,y:0}):e[n]<t&&this.docRender.goToPage(e[0],{x:0,y:0})}},t.prototype.prev=function(e){var t=this.getItems(),n=this.scrollHost.clientWidth,o=t.eq(e).width()-n;o>=1?this.jumpToPage(e,{x:o,y:0}):this.jumpToPage(e,{x:0,y:0})},t.prototype.jumpToPage=function(e,t){var n=t.x,o=void 0===n?0:n,r=t.y,i=void 0===r?0:r,s=this.getItems();e>=s.length?e=s.length-1:e<0&&(e=0);var d=s[e],a=d.offsetLeft+o,c=d.offsetTop+i;this.docRender.viewerRender.scrollWrap.scrollTo(a,c)},t.prototype.getCurrentPageIndex=function(){for(var e=this.docRender.$ui,t=this.getItems(),n=this.docRender.viewerRender.scrollWrap,o=(n.getScrollTop(),e.height(),n.getScrollLeft()),r=o+e.width(),i=void 0,s=[],a=0;a<t.length;a++){var c=t[a],l=c.offsetLeft,u=d(c).width(),f=l+u;l<=o&&f>o&&f<r?s.push({index:a,width:f-o}):l>=o&&f<r?s.push({index:a,width:u}):l<=o&&f>r?i=a:l>=o&&l<r&&f>r&&s.push({index:a,width:r-l})}if(null==i)for(var p=0,h=0;h<s.length;h++)s[h].width>p&&(p=s[h].width,i=s[h].index);return i},t.prototype.getFitHeight=function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()},t.prototype.getFitWidth=function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getWidth()-t.getScrollOffsetLeft()},t.prototype.getVisibleIndexes=function(){var e=this.docRender.viewerRender.scrollWrap,t=e.getScrollLeft()-e.getScrollOffsetLeft(),n=this.docRender.$ui.width(),o=t+n,r=[];return this.getItems().each((function(e,n){var i=n.offsetLeft,s=n.offsetWidth+i;t<s&&o>i&&r.push(e)})),r},t.prototype.getNextPageIndex=function(){var e=this.docRender.doc.getPageCount(),t=this.docRender.currentPageIndex;return t<e-1&&t++,t},t.prototype.getPrevPageIndex=function(){var e=this.docRender.currentPageIndex;return e>0&&e--,e},t.prototype.out=function(){this.enableScroll(),this.pdfViewer.eventEmitter.off(c.fitWidthResizeViewport,this.resize),this.scrollHost.removeEventListener("mousedown",this.mousedown),d(window).off("mouseup",this.mouseup),d(window).off("keydown",this.keydown),d(window).off("keyup",this.keyup),this.hammer.destroy(),this.pdfViewer.eventEmitter.off(c.fitWidthResizeViewport,this.resize),this.pdfViewer.eventEmitter.off(c.zoomToSuccess,this.zoom),this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.$ui.parents(".fv__ui-pdfviewer").css({"overflow-x":"","overflow-y":""}),this.$style&&this.$style.remove();for(var e=this.getItems(),t=0;t<e.length;t++)e.eq(t).css({width:""})},t}(i.IViewMode);t.default=l}]).default}));