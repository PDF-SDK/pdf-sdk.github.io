!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("PDFViewCtrl")):"function"==typeof define&&define.amd?define(["PDFViewCtrl"],t):"object"==typeof exports?exports.FacingContinuousViewMode=t(require("PDFViewCtrl")):e.FacingContinuousViewMode=t(e.PDFViewCtrl)}(self,(function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(1);function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var i=r[n],o=Object.getOwnPropertyDescriptor(t,i);o&&o.configurable&&void 0===e[i]&&Object.defineProperty(e,i,o)}}(e,t))}var a=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n.multipage=2,n}return o(t,e),t.getName=function(){return"facing-continuous-page-view-mode"},t}(((n=i)&&n.__esModule?n:{default:n}).default);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(2));function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var i=r[n],o=Object.getOwnPropertyDescriptor(t,i);o&&o.configurable&&void 0===e[i]&&Object.defineProperty(e,i,o)}}(e,t))}var o=n.IViewMode,a=n.vendors.jQuery,s=2,c=10,u=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n.multipage=s,n.pageSpacing=c,n.isJump=!1,n.isCurrentViewMode=!0,n}return i(t,e),t.getName=function(){return"multipage-view-mode"},t.setMultipage=function(e){s=e},t.getMultipage=function(){return s},t.setPageSpacing=function(e){c=e},t.getPageSpacing=function(){return c},t.prototype.getItems=function(){return a(e.prototype.getItems.call(this))},t.prototype.into=function(t,r){this.isCurrentViewMode=!0,e.prototype.into.call(this,t,r);var n=this.constructor.getName(),i=["<style>","."+n+"{","overflow:hidden;","margin:0 auto;","}","."+n+" .fv__pdf-view-mode-item{","float: left;","display: -webkit-box;","display: -ms-flexbox;","display: -webkit-flex;","display: flex;","-ms-flex-pack: center;","-ms-flex-align: center;","-ms-justify-content: center;","-webkit-justify-content: center;","justify-content: center;","align-items: center;","width:calc("+100/this.multipage+"% - "+this.pageSpacing*(this.multipage-1)/this.multipage+"px)","}","."+n+" .fv__pdf-view-mode-item{","margin-right: "+this.pageSpacing+"px;","}","."+n+" .fv__pdf-page-layout{","width: 100%;","}","."+n+" .fv__pdf-view-mode-item:nth-child("+this.multipage+"n){","margin-right: 0;","}","."+n+" .fv__pdf-view-mode-item:nth-of-type(odd) .fv__pdf-page-layout{","margin-right: 0;","margin-left: 0px","}","."+n+" .fv__pdf-view-mode-item:nth-of-type(even) .fv__pdf-page-layout{","margin-left: 0;","}","</style>"].join("");this.$style=a(i),this.docRender.$container.after(this.$style),this.docRender.$container.addClass(this.constructor.getName()),this.initPageLayout()},t.prototype.bindScrollEvent=function(){var e=this;this._unwatchScrollEvent&&this._unwatchScrollEvent();var t=this.docRender.viewerRender.scrollWrap,r=!1,n=t.addScrollEventListener((function(){clearTimeout(e.scrollEventTimer),e.scrollEventTimer=setTimeout((function(){if(!r){var t=e.docRender;if(t){e.isJump=!1;var n=t.pagesRender;n&&n.renderVisiblePages().then((function(){t.isGoto?setTimeout((function(){e.isCurrentViewMode&&(t.isGoto=!1)}),40):t.setCurrentPageIndex(e.getCurrentPageIndex())}),(function(){}))}}}),100)}));this._unwatchScrollEvent=function(){r=!0,e._unwatchScrollEvent=function(){},n()}},t.prototype.initPageLayout=function(){var e=this.getItems(),t=this.multipage,r=this.pageSpacing*(t-1)/t;e.css({width:"calc("+100/t+"% - "+r+"px)"})},t.prototype.out=function(){this.isCurrentViewMode=!1,this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.pagesRender.$ui.removeAttr("style"),this.$style&&this.$style.remove(),this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.getItems().css({width:"",height:""}),e.prototype.out.call(this)},t.prototype.updatePagesRenderSize=function(){var e=this,t=this.getMaxPageWidth(),r=this.multipage,n=(r-1)*this.pageSpacing;this.docRender.getScaleRatio().then((function(i){e.docRender.pagesRender.$ui.css({width:t*r*i+n})}))},t.prototype.afterRenderVisiblePages=function(){this.updatePagesRenderSize()},t.prototype.renderViewMode=function(e,t,r,n,i){var o=this;if(this.docRender){var s=e.index,c=this.getMaxPageWidth(),u=this.multipage,d=(u-1)*this.pageSpacing;this.docRender.pagesRender.$ui.css({width:c*u*t+d});for(var l=Math.floor(s/u),f=0,p=this.docRender.doc.getPageCount(),h=[],g=this.docRender.getRotation(),v=0;v<u;v++){var y=l*u+v;y<p&&h.push(this.docRender.getPDFDoc().getPageByIndex(y).then((function(e){var t=void 0;t=90===g||270===g?e.getPxWidth():e.getPxHeight(),f=Math.max(t,f),t})))}Promise.all(h).then((function(){var e=o.getItems();a(e[s]).css({height:f*t})})).catch((function(e){0}))}},t.prototype.getPagesLayout=function(){for(var e=this.docRender.doc.pageCache,t=e.length,r=this.multipage,n=Math.ceil(t/r),i=Array(r).fill(0),o=Array(n).fill(0),a=0;a<r;a++)for(var s=a;s<t;s+=r)i[a]=Math.max(i[a],e[s].getPxWidth());for(var c=0;c<n;c++)for(var u=0;u<r;u++)e[c*r+u]&&(o[c]=Math.max(o[c],e[c*r+u].getPxHeight()));var d=[];return e.forEach((function(e,t){d.push({width:i[t%r],height:o[Math.floor(t/3)]})})),d},t.prototype.getMaxPageWidth=function(){var e=0,t=this.docRender.doc.getPageSizesSync(),r=this.docRender.getRotation(),n=void 0;for(var i in n=90===r||270===r?"height":"width",t){var o=4*t[i][n]/3;o>e&&(e=o)}return e},t.prototype.getFitHeight=function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()},t.prototype.getFitWidth=function(e){var t=this.getMaxPageWidth(),r=this.docRender.viewerRender.scrollWrap,n=this.multipage,i=(r.getWidth()-16-n*this.pageSpacing)/n,o=this.docRender.doc.getPageSize(e),a=this.docRender.getRotation();if(o){return i*(90===a||270===a?o.height:o.width)*4/(3*t)}},t.prototype.jumpToPage=function(e,t){var r=this,n=t.x,i=void 0===n?0:n,o=t.y,a=void 0===o?0:o;this.isJump=!0;var s=this.getItems();e>=s.length?e=s.length-1:e<0&&(e=0);var c=s.eq(e),u=c.position().left+i,d=c.position().top+a;this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender.viewerRender.scrollWrap.scrollTo(u,d),this.currentJumpPageIndex=e,this.docRender.setCurrentPageIndex(e),setTimeout((function(){r.isCurrentViewMode&&r.bindScrollEvent()}))},t.prototype.getVisibleIndexes=function(){var e=this.docRender.viewerRender.scrollWrap,t=e.getScrollTop(),r=e.getHeight(),n=t+r,i=[];this.multipage;return this.getItems().each((function(e,r){if(0>n)return!1;var o=a(r).outerHeight(!0),s=r.offsetTop;s<=n&&s+o>=t&&i.push(e)})),i},t.prototype.getCurrentPageIndex=function(){if(this.isJump)return this.currentJumpPageIndex;for(var e=this.getItems(),t=this.docRender.viewerRender.scrollWrap,r=t.getScrollTop(),n=r+t.getHeight(),i=t.getScrollLeft(),o=i+t.getWidth(),s=void 0,c=[],u=0;u<e.length;u++){var d=e[u],l=a(d).width(),f=a(d).height(),p=d.offsetTop,h=p+f,g=d.offsetLeft,v=g+l,y=void 0;if(p<=r&&h>r&&h<n?y=h-r:p>=r&&h<n?y=f:p<=r&&h>n?y=n-r:p>=r&&p<n&&h>n&&(y=n-p),y){var m=void 0;g<=i&&v>i&&v<o?(m=v-i,c.push({index:u,area:y*m})):g>=i&&v<o?(m=l,c.push({index:u,area:y*m})):g<=i&&v>o?(m=o-i,c.push({index:u,area:y*m})):g>=i&&g<o&&v>o&&(m=o-g,c.push({index:u,area:y*m}))}}for(var w=0,P=0;P<c.length;P++)c[P].area>w&&(w=c[P].area,s=c[P].index);return s},t.prototype.getNextPageIndex=function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();if(t<e-1){var r=this.docRender.viewerRender.scrollWrap,n=this.docRender.pagesRender.$ui.width(),i=r.getWidth()-16,o=this.multipage;if(i>=n)t=Math.ceil((t+1)/o)*o;else t++}return t>e-1&&(t=e-1),t},t.prototype.getPrevPageIndex=function(){var e=this.getCurrentPageIndex();if(e>0){var t=this.docRender.viewerRender.scrollWrap,r=this.docRender.pagesRender.$ui.width(),n=t.getWidth()-16,i=this.multipage;if(n>=r)e=(Math.ceil((e+1)/i)-2)*i;else e--}return e<0&&(e=0),e},t}(o);t.default=u},function(t,r){t.exports=e}]).default}));